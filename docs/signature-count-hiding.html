<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XMSS Library: Signature count hiding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="katex.min.css" rel="stylesheet" type="text/css"/>
<!-- KaTeX -->
<script type="text/javascript" defer src="katex.min.js"></script>
<script type="text/javascript" defer src="auto-render.min.js"></script>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            macros: {
                '\\Keccak': '\\text{K\\footnotesize{ECCAK}}'
            }
        });
    });
</script>
<!-- end: KaTeX -->
<!-- Doxygen Awesome -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<!-- end: Doxygen Awesome -->
<!-- Final overrides (glue) -->
<link href="custom.css" rel="stylesheet" type="text/css"/>
<!-- end: Final overrides (glue) -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FOX-CRYPTO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XMSS Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('signature-count-hiding.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Signature count hiding </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md12">Problem definition</a></li>
<li class="level1"><a href="#autotoc_md13">Index obfuscation</a><ul><li class="level2"><a href="#autotoc_md14">When to use index obfuscation</a></li>
<li class="level2"><a href="#autotoc_md15">Implications of using index obfuscation</a></li>
<li class="level2"><a href="#autotoc_md16">Impact on security</a></li>
<li class="level2"><a href="#autotoc_md17">Impact on back-ups</a></li>
<li class="level2"><a href="#autotoc_md18">Interoperability</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md19">Conclusion</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_gitlab_runner_builds_Ybiz_PBn_0_crypto_xmss_documentation_build_docs_0050_signature_count_hiding"></a></p>
<p>The key generation API allows to enable index obfuscation, which can help hide the number of signatures created with a private key. This document provides guidance for when to use index obfuscation and what the implications of enabling index obfuscation are.</p>
<h1><a class="anchor" id="autotoc_md12"></a>
Problem definition</h1>
<p>Depending on the usage scenario, the number of signatures created using a private key may be considered sensitive information. In XMSS, each OTS key is denoted by it's index, and each OTS key may be used only once. The straight forward way of preventing index re-use is to store a counter value along with the other parts that comprise the private key. In that case, someone in possession of one signature also knows the exact number of signatures generated at the time of signing. Since OTS re-use compromises the security of a private key, picking a random index is not a solution, however it is possible to select an index using a pseudo-random permutation of the index space.</p>
<p>Naturally, the upper limit on the number of signatures that can be generated with a single private key cannot be obfuscated as that information is required to be able to verify a signature's authenticity.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Index obfuscation</h1>
<p>When generating a private key, index obfuscation can be enabled or disabled for the lifetime of the private key with <code>XMSS_INDEX_OBFUSCATION_ON</code> and <code>XMSS_INDEX_OBFUSCATION_OFF</code> respectively.</p>
<p>If a private key is generated with the index obfuscation enabled, all signatures generated with that private key will be generated using an obfuscated index.</p>
<p>Index obfuscation is implemented with the Fisher-Yates shuffle algorithm.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
When to use index obfuscation</h2>
<p>It's advised to use index obfuscation only when there is a reason to hide the number of signatures. When making this decision, it should be taken into consideration that index obfuscation cannot be enabled for a private key after the private key has been generated.</p>
<p>If the number of signatures is considered sensitive information, also consider what information is leaked through the parameter set <code>OID</code> and choose the parametrization accordingly.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Implications of using index obfuscation</h2>
<p>Enabling index obfuscation has the following implications:</p>
<ol type="1">
<li>Increased memory (RAM) use when a key is loaded or generated, depending on the tree depth:<ul>
<li>4 MiB for tree depth of 20.</li>
<li>256 KiB for tree depth of 16.</li>
<li>4 KiB for tree depth of 10.</li>
</ul>
</li>
<li>Increased processing time to create a signature, as the extra checks are required to ensure that no index re-use can occur in case of bit errors. The performance impact is small compared to the speedup that can be achieved by using a public key cache.</li>
</ol>
<h2><a class="anchor" id="autotoc_md16"></a>
Impact on security</h2>
<p>This XMSS signing library is designed and implemented to manage indexes securely even in case of an accidental single bit error. Even in the event of a bit flip in RAM, a register, or in a stored private key part, an index should never be re-used, provided that the guidance for using this library is followed.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Impact on back-ups</h2>
<p>The index obfuscation is implemented in such a way that all index management in the library is done on pre-obfuscated indexes, so there is no impact on back-ups and index space partitioning. Based on the information in a signature, attackers cannot learn which partition was used to sign a message. If multiple partitions are used for load balancing over multiple systems, an attacker cannot determine which system was used to create a signature. Similarly, attackers are unable to determine if a back-up has been taken into operation based on the information in any signature.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Interoperability</h2>
<p>The use of index obfuscation does not impact verification, so signatures generated with index obfuscation are fully compatible with any other standard-compliant XMSS implementation.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Conclusion</h1>
<p>Index obfuscation allows for hiding:</p>
<ul>
<li>the number of signatures generated with a private key,</li>
<li>the order in which signatures have been generated with a private key, and</li>
<li>which system (in case of redundant signing stations for a private key) has generated the signature.</li>
</ul>
<p>Enabling index obfuscation does increase the memory footprint and decrease signing performance. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
<!-- Mermaid -->
<script type="text/javascript" defer src="mermaid.min.js"></script>
<!-- end: Mermaid -->
</html>
