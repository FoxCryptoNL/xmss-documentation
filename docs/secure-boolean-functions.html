<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XMSS Library: Secure boolean functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="katex.min.css" rel="stylesheet" type="text/css"/>
<!-- KaTeX -->
<script type="text/javascript" defer src="katex.min.js"></script>
<script type="text/javascript" defer src="auto-render.min.js"></script>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            macros: {
                '\\Keccak': '\\text{K\\footnotesize{ECCAK}}'
            }
        });
    });
</script>
<!-- end: KaTeX -->
<!-- Doxygen Awesome -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<!-- end: Doxygen Awesome -->
<!-- Final overrides (glue) -->
<link href="custom.css" rel="stylesheet" type="text/css"/>
<!-- end: Final overrides (glue) -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FOX-CRYPTO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XMSS Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('secure-boolean-functions.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Secure boolean functions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md24">Problem definition</a></li>
<li class="level1"><a href="#autotoc_md25">Rationale for using Hamming codes</a><ul><li class="level2"><a href="#autotoc_md26">Rationale for not using a value with all bits 0</a></li>
<li class="level2"><a href="#autotoc_md27">Relation to functions returning an error code</a></li>
<li class="level2"><a href="#autotoc_md28">Rationale for using 8-bit values on 32/64-bit platforms</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md29">Conclusion</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_gitlab_runner_builds_Ybiz_PBn_0_crypto_xmss_documentation_build_docs_0100_secure_boolean_functions"></a></p>
<p>This document provides the rationale for <em>not</em> having API functions returning naive boolean values.</p>
<h1><a class="anchor" id="autotoc_md24"></a>
Problem definition</h1>
<p>Different users of the XMSS library have different requirements for bit error resilience. We consider the following problems with simple booleans:</p>
<ol type="1">
<li><p class="startli">Single upset events.</p>
<p class="startli">A single upset event can flip a single bit in the return value, or sometimes even the adjacent bits. This could turn a value of zero into a value of non-zero, or it could turn a non-zero value (most notably the value one, a common value for <code>true</code>) into a value of zero. A single upset event could invert the naive values zero for <code>false</code> and one for <code>true</code>.</p>
</li>
<li>Fault injections.<ol type="a">
<li>An attacker may (e.g., by power glitching) induce well-timed bit flips in the underlying hardware, effectively inverting the boolean interpretation of the returned value.</li>
<li>An attacker may (e.g., by clock glitching) replace entire bit sequences with sequences of 0 or 1. With such attacks it is possible to turn any return value into the value zero, a value that is often used to indicate success in C.</li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md25"></a>
Rationale for using Hamming codes</h1>
<p>To mitigate both problems, the API always returns values that have a Hamming distance of at least 4 bits</p>
<ul>
<li>with respect to each other,</li>
<li>from the value 0 (represented by all bits 0), and</li>
<li>from the value represented by all bits 1.</li>
</ul>
<p>In practice, the API uses the extended Hamming(8,4) code. Note that even though this code allows to correct for single bit errors, we recommend against using error correction at all. Instead, it is recommended to only detect bit errors and to handle any failures appropriately.</p>
<p>The Hamming(8,4) codes consist of 16 different data values using 8 bits, one of which is represented by all bits 0.</p>
<p>The value with all bits 0 is not used.</p>
<p>One non-zero value is selected to represent <code>true</code>, another non-zero value is selected to represent <code>false</code>.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Rationale for not using a value with all bits 0</h2>
<p>One identified fault injection attack is to replace all bits with 0. This is mitigated by requiring that a value with all bits 0 is never a valid return value.</p>
<h2><a class="anchor" id="autotoc_md27"></a>
Relation to functions returning an error code</h2>
<p>The remaining 13 Hamming(8,4) codes, excluding the values for <code>true</code> and <code>false</code> and excluding the value with all bits 0, are available to bit error resilient error and/or success values.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Rationale for using 8-bit values on 32/64-bit platforms</h2>
<p>The API always uses return type <code>int</code>, which is at least 32 bits on the supported platforms. Therefore, all Hamming(8,4) codes have a Hamming distance of at least 24 with respect to the fault injection attack forcing all bits to 1.</p>
<p>Some instruction sets are optimized for comparison with immediate 8-bit values. Even though a return value is usually of type <code>int</code>, which is usually 32 bits, it is still beneficial to restrict the return values to 8 bits when possible. In case more than 15 different return values are required, it is recommended to use the 15 non-zero Hamming(8,4) codes for the most common values and augment them with other values beyond 8 bits and restrict those values to also having a Hamming distance of at least 4 with respect to each other and with respect to the Hamming(8,4) codes.</p>
<h1><a class="anchor" id="autotoc_md29"></a>
Conclusion</h1>
<p>The API ensures that both logical return values <code>true</code> and <code>false</code> are resilient against any 1, 2, or 3 bit errors, as well as against replacing all bits of the return value with either 0 or 1.</p>
<p>The API furthermore allows for up to 13 efficient, bit error resilient, success/error return values. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
<!-- Mermaid -->
<script type="text/javascript" defer src="mermaid.min.js"></script>
<!-- end: Mermaid -->
</html>
