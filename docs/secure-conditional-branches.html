<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XMSS Library: Secure conditional branches</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="katex.min.css" rel="stylesheet" type="text/css"/>
<!-- KaTeX -->
<script type="text/javascript" defer src="katex.min.js"></script>
<script type="text/javascript" defer src="auto-render.min.js"></script>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            macros: {
                '\\Keccak': '\\text{K\\footnotesize{ECCAK}}'
            }
        });
    });
</script>
<!-- end: KaTeX -->
<!-- Doxygen Awesome -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<!-- end: Doxygen Awesome -->
<!-- Final overrides (glue) -->
<link href="custom.css" rel="stylesheet" type="text/css"/>
<!-- end: Final overrides (glue) -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FOX-CRYPTO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XMSS Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('secure-conditional-branches.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Secure conditional branches </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md35">Problem definition</a></li>
<li class="level1"><a href="#autotoc_md36">Secret data</a></li>
<li class="level1"><a href="#autotoc_md37">Single branches</a></li>
<li class="level1"><a href="#autotoc_md38">Signing API</a></li>
<li class="level1"><a href="#autotoc_md39">Verification API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_gitlab_runner_builds_Ybiz_PBn_0_crypto_xmss_documentation_build_docs_0110_secure_conditional_branches"></a></p>
<p>This document provides the rationale for security-related conditional branches.</p>
<h1><a class="anchor" id="autotoc_md35"></a>
Problem definition</h1>
<p>We consider the following problems with conditional branches:</p>
<ol type="1">
<li><p class="startli">Single upset events.</p>
<p class="startli">A single upset event can flip a single bit in the status register of the underlying hardware that controls the conditional branch. For example, the condition 'authentication succeeded' could be reversed.</p>
</li>
<li><p class="startli">Fault injections.</p>
<p class="startli">An attacker may (e.g., by clock glitching) make the underlying hardware skip an instruction. A well-timed attack could skip the conditional branch instruction completely, effectively making the hardware behave as if the condition was false irrespective of its actual value.</p>
</li>
<li><p class="startli">Data leakage.</p>
<p class="startli">An attacker may be able to observe the consumed power or the total running time to determine whether or not the branch condition was true or false. If the branching condition was based on secret data, (parts of) the secret data are leaked by such attacks, compromising confidentiality.</p>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md36"></a>
Secret data</h1>
<p>The API never branches on secret data. This is also a PQClean requirement.</p>
<h1><a class="anchor" id="autotoc_md37"></a>
Single branches</h1>
<p>Consider the following code:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (!authentication_succeeded)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"><span class="comment">// actions follow that require authentication</span></div>
</div><!-- fragment --><p>A single, well-timed instruction skip could bypass the authorization check entirely.</p>
<p>Now consider the following code:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma optimize(off)</span></div>
<div class="line"><span class="keywordflow">if</span> (authentication_succeeded == RESILIENT_FALSE)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (authentication_succeeded != RESILIENT_TRUE)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#pragma optimize(restore)</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">// actions follow that require authentication</span></div>
</div><!-- fragment --><p>This requires at least two branch instructions to be skipped, which is a much harder feat to accomplish for an attacker. Furthermore, the branch condition uses bit error resilient values as explained in <a class="el" href="secure-boolean-functions.html">Secure boolean functions</a>.</p>
<p>It is up to the user of the XMSS library to determine to which degree instruction-skip resilience is required. Note that compilers must be instructed to not optimize away any redundant condition checks.</p>
<h1><a class="anchor" id="autotoc_md38"></a>
Signing API</h1>
<p>The signing API uses twofold condition redundancy.</p>
<h1><a class="anchor" id="autotoc_md39"></a>
Verification API</h1>
<p>The verification API returns a type of which the defined values have a hamming-distance of 4 (see <a class="el" href="secure-boolean-functions.html">Secure boolean functions</a> for a rationale). It is up to the user to do secure conditional branching on the returned value for the desired level of fault injection resilience. See <a class="el" href="signature-verification.html">Signature verification</a> for guidance on secure usage the verification API for specific usage scenarios and security requirements. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
<!-- Mermaid -->
<script type="text/javascript" defer src="mermaid.min.js"></script>
<!-- end: Mermaid -->
</html>
