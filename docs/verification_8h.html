<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XMSS Library: verification.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="katex.min.css" rel="stylesheet" type="text/css"/>
<!-- KaTeX -->
<script type="text/javascript" defer src="katex.min.js"></script>
<script type="text/javascript" defer src="auto-render.min.js"></script>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            macros: {
                '\\Keccak': '\\text{K\\footnotesize{ECCAK}}'
            }
        });
    });
</script>
<!-- end: KaTeX -->
<!-- Doxygen Awesome -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<!-- end: Doxygen Awesome -->
<!-- Final overrides (glue) -->
<link href="custom.css" rel="stylesheet" type="text/css"/>
<!-- end: Final overrides (glue) -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FOX-CRYPTO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XMSS Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('verification_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">verification.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Public API for the XMSS verification library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="structures_8h_source.html">structures.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="types_8h_source.html">types.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for verification.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="verification_8h__incl.svg" width="347" height="411"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="verification_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a911476bad5dfc311cf4e4c82a6168298"><td class="memItemLeft" align="right" valign="top"><a id="a911476bad5dfc311cf4e4c82a6168298"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="verification_8h.html#a911476bad5dfc311cf4e4c82a6168298">XMSS_VERIFICATION_H_INCLUDED</a></td></tr>
<tr class="memdesc:a911476bad5dfc311cf4e4c82a6168298"><td class="mdescLeft">&#160;</td><td class="mdescRight">Include guard. <br /></td></tr>
<tr class="separator:a911476bad5dfc311cf4e4c82a6168298"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a70e68b3b9e69d04dc4654c02bfa1993e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a5c29fa42780309b65c50759b4c7b65f8">XmssError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="verification_8h.html#a70e68b3b9e69d04dc4654c02bfa1993e">xmss_calculate_expected_public_key</a> (<a class="el" href="structXmssValue256.html">XmssValue256</a> *restrict expected_public_key, const <a class="el" href="structXmssBuffer.html">XmssBuffer</a> *restrict msg, const <a class="el" href="structXmssPublicKeyBlob.html">XmssPublicKeyBlob</a> *restrict pub_key, const <a class="el" href="structXmssSignatureBlob.html">XmssSignatureBlob</a> *restrict signature)</td></tr>
<tr class="memdesc:a70e68b3b9e69d04dc4654c02bfa1993e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the expected public key for a given message and signature.  <a href="verification_8h.html#a70e68b3b9e69d04dc4654c02bfa1993e">More...</a><br /></td></tr>
<tr class="separator:a70e68b3b9e69d04dc4654c02bfa1993e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Public API for the XMSS verification library. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a70e68b3b9e69d04dc4654c02bfa1993e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70e68b3b9e69d04dc4654c02bfa1993e">&#9670;&nbsp;</a></span>xmss_calculate_expected_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a5c29fa42780309b65c50759b4c7b65f8">XmssError</a> xmss_calculate_expected_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structXmssValue256.html">XmssValue256</a> *restrict&#160;</td>
          <td class="paramname"><em>expected_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structXmssBuffer.html">XmssBuffer</a> *restrict&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structXmssPublicKeyBlob.html">XmssPublicKeyBlob</a> *restrict&#160;</td>
          <td class="paramname"><em>pub_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structXmssSignatureBlob.html">XmssSignatureBlob</a> *restrict&#160;</td>
          <td class="paramname"><em>signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the expected public key for a given message and signature. </p>
<p>This does not verify the correctness of the public key. Returning a single value to indicate 'good' or 'bad' is not resilient enough for many use cases. Implementations can use the expected public key in a verification algorithm that provides the level of resilience that meets their needs, ranging from a simple entirely non-resilient memcmp() to a fully fault injection-proof check with multiple redundancies.</p>
<p>The public key is still passed to this function, but only for the additional public data it contains. This data is used to calculate both part of the signature and part of the public key that would verify the signature's correctness.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">expected_public_key</td><td>The 32-byte public key that would be calculated from the signature and the message. If and only if this matches the actual public key, then the signature is valid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>The arbitrary-length message to calculate the expected public key for. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pub_key</td><td>The public key to verify against. This is <em>not</em> used to actually verify the signature but contains (public) data that is needed to calculate the expected public key from the message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>The signature over the message that needs to be verified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">XMSS_OKAY</td><td>The calculation was successful. Note that this does not necessarily mean that the signature is valid. </td></tr>
    <tr><td class="paramname">XMSS_ERR_NULL_POINTER</td><td>A NULL pointer was passed. </td></tr>
    <tr><td class="paramname">XMSS_ERR_INVALID_ARGUMENT</td><td>The scheme identifier in pub_key is not supported or invalid. </td></tr>
    <tr><td class="paramname">XMSS_ERR_INVALID_BLOB</td><td>The data in pub_key or signature is not valid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="verification_8h.html">verification.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
<!-- Mermaid -->
<script type="text/javascript" defer src="mermaid.min.js"></script>
<!-- end: Mermaid -->
</html>
